<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Productivity Report</title>

  <!-- Bootstrap & Chart.js -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    body { background:#f8f9fa; font-family:system-ui; color:#333; padding:20px; }
    .card { border:none; border-radius:10px; box-shadow:0 1px 5px rgba(0,0,0,0.1); }
    h5 { font-size:1rem; margin-bottom:.25rem; }
    footer { font-size:.8rem; color:#777; text-align:center; margin-top:20px; }
    canvas { max-height:200px; }
  </style>
</head>
<body>
  <div class="container small">

    <h4 class="text-center text-primary mb-3">ðŸ“Š Productivity Report</h4>

    <div class="row g-2 text-center mb-3">
      <div class="col-4"><div class="card p-2"><h5 class="text-success">15</h5><small>Weekly Done</small></div></div>
      <div class="col-4"><div class="card p-2"><h5 class="text-info">5</h5><small>Ongoing</small></div></div>
      <div class="col-4"><div class="card p-2"><h5 class="text-danger">2</h5><small>Due</small></div></div>
    </div>

    <div class="card p-3 mb-3">
      <h6 class="text-muted text-center">Weekly Tasks Overview</h6>
      <canvas id="weeklyChart"></canvas>
    </div>

    <div class="card p-3">
      <h6 class="text-muted text-center">Monthly Summary</h6>
      <canvas id="monthlyChart"></canvas>
    </div>

    <footer>Updated: <span id="date"></span> â€¢ Â© 2025 Productivity Tracker</footer>
  </div>

  <script nonce="<%= cspNonce %>">
    document.getElementById("date").textContent = new Date().toLocaleDateString();

    new Chart(document.getElementById('weeklyChart'), {
      type: 'bar',
      data: {
        labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
        datasets: [
          { label:'Done', data:[3,2,1,4,2,1,2], backgroundColor:'rgba(25,135,84,.8)' },
          { label:'Ongoing', data:[1,2,2,1,2,0,1], backgroundColor:'rgba(13,110,253,.7)' },
          { label:'Due', data:[0,0,1,0,0,1,0], backgroundColor:'rgba(220,53,69,.7)' }
        ]
      },
      options:{ responsive:true, plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}} }
    });

    new Chart(document.getElementById('monthlyChart'), {
      type: 'doughnut',
      data: {
        labels:['Completed','Ongoing','Due'],
        datasets:[{ data:[70,20,10],
          backgroundColor:['rgba(25,135,84,.8)','rgba(13,110,253,.7)','rgba(220,53,69,.7)'] }]
      },
      options:{ plugins:{legend:{position:'bottom'}} }
    });
  </script>
</body>
</html>